# -*- coding: utf-8 -*-
--- !testcase
testcase_id: TD_6LowPAN_FORMAT_01
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle uncompressed 6LowPAN packets (EUI-64 linklocal)
pre_conditions: 
  - Header compression is disabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use EUI-64
references: 'RFC 4944 5.1, 8'
sequence:
  - step_id: 'TD_6LowPAN_FORMAT_01_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes

  - step_id: 'TD_6LowPAN_FORMAT_01_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends an uncompressed 6LowPAN packet containing the Echo Request message to EUT2's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Both source and destination addresses are EUI-64 linklocal

  - step_id: 'TD_6LowPAN_FORMAT_01_step_02'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_FORMAT_01_step_03'
    type: check
    node : IUT2
    description:
      - EUT2 sends an uncompressed 6LowPAN packet containing the Echo Reply message to EUT1's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Both source and destination addresses are EUI-64 linklocal

  - step_id: 'TD_6LowPAN_FORMAT_01_step_04'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2

  - step_id: 'TD_6LowPAN_FORMAT_01_step_05'
    type: check
    node : IUT1
    description:
      - The data received in the echo reply message is identical to that sent in EUT1's echo request message

--- !testcase

testcase_id: TD_6LowPAN_FORMAT_02
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle uncompressed 6LowPAN packets (16-bit linklocal)
pre_conditions: 
  - Header compression is disabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use 16-bit short address
references: 'RFC 4944 5.1, 8'
sequence:
  - step_id: 'TD_6LowPAN_FORMAT_02_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes

  - step_id: 'TD_6LowPAN_FORMAT_02_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends an uncompressed 6LowPAN packet containing the Echo Request message to EUT2's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Both source and destination addresses are 16 bit short link-local

  - step_id: 'TD_6LowPAN_FORMAT_02_step_02'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_FORMAT_02_step_03'
    type: check
    node : IUT2
    description:
      - EUT2 sends an uncompressed 6LowPAN packet containing the Echo Reply message to EUT1's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Both source and destination addresses are 16 bit short link-local

  - step_id: 'TD_6LowPAN_FORMAT_02_step_04'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2

  - step_id: 'TD_6LowPAN_FORMAT_02_step_05'
    type: check
    node : IUT1
    description:
      - The data received in the echo reply message is identical to that sent in EUT1's echo request message

--- !testcase

testcase_id: TD_6LowPAN_FORMAT_03
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle uncompressed 6LowPAN fragmented packets
pre_conditions: 
  - Header compression is disabled on both EUT1 and EUT2
references: 'RFC 4944 5.1, 5.3'
sequence:
  - step_id: 'TD_6LowPAN_FORMAT_03_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 253 bytes, total IPv6 size 301 bytes

  - step_id: 'TD_6LowPAN_FORMAT_03_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends a sequence of uncompressed 6LowPAN packets containing the Echo Request fragments to EUT2
      - EUT1 correctly fragments the Echo Request:''
      - - a 6LowPAN FRAG1 header (dispatch 11000xxx) is included in the first packet
      - - a 6LowPAN FRAGN header (dispatch 11100xxx) is included in all following packets
      - - the offsets form a contiguous sequence
      - - all fragments except the last one must be multiples of 8 bytes

  - step_id: 'TD_6LowPAN_FORMAT_03_step_02'
    type: verify
    node : IUT2
    description:
      - EUT2 reassembles correctly the fragments and receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_FORMAT_03_step_03'
    type: check
    node : IUT2
    description:
      - EUT2 sends a sequence of uncompressed 6LowPAN packets containing the Echo Reply message to EUT1
      - EUT2 correctly fragments the Echo Reply:''
      - - a 6LowPAN FRAG1 header (dispatch 11000xxx) is included in the first packet
      - - a 6LowPAN FRAGN header (dispatch 11100xxx) is included in all following packets
      - - the offsets form a contiguous sequence
      - - all fragments except the last one must be multiples of 8 bytes
      - - The data in the echo reply message packets is identical to that sent in the echo request message packets

  - step_id: 'TD_6LowPAN_FORMAT_03_step_04'
    type: verify
    node : IUT1
    description:
      - EUT1 correctly reassembles the fragments and receives the Echo Reply message from EUT2

  - step_id: 'TD_6LowPAN_FORMAT_03_step_05'
    type: verify
    node : IUT1
    description:
      - The data in the received echo reply message is identical to that sent in the echo request message

--- !testcase

testcase_id: TD_6LowPAN_FORMAT_04
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle maximum size uncompressed 6LowPAN fragmented packets
pre_conditions: 
  - Header compression is disabled on both EUT1 and EUT2
references: 'RFC 4944 5.1, 5.3'
sequence:
  - step_id: 'TD_6LowPAN_FORMAT_04_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 1232 bytes, total IPv6 size 1280 bytes

  - step_id: 'TD_6LowPAN_FORMAT_04_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends a sequence of uncompressed 6LowPAN packets containing the Echo Request fragments to EUT2
      - EUT1 correctly fragments the Echo Request:''
      - - a 6LowPAN FRAG1 header (dispatch 11000xxx) is included in the first packet
      - - a 6LowPAN FRAGN header (dispatch 11100xxx) is included in all following packets
      - - the offsets form a contiguous sequence
      - - all fragments except the last one must be multiples of 8 bytes

  - step_id: 'TD_6LowPAN_FORMAT_04_step_02'
    type: verify
    node : IUT2
    description:
      - EUT2 reassembles correctly the fragments and receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_FORMAT_04_step_03'
    type: check
    node : IUT2
    description:
      - EUT2 sends a sequence of uncompressed 6LowPAN packets containing the Echo Reply message to EUT1
      - EUT2 correctly fragments the Echo Reply:''
      - - a 6LowPAN FRAG1 header (dispatch 11000xxx) is included in the first packet
      - - a 6LowPAN FRAGN header (dispatch 11100xxx) is included in all following packets
      - - the offsets form a contiguous sequence
      - - all fragments except the last one must be multiples of 8 bytes
      - - The data in the echo reply message packets is identical to that sent in the echo request message packets

  - step_id: 'TD_6LowPAN_FORMAT_04_step_04'
    type: verify
    node : IUT1
    description:
      - EUT1 correctly reassembles the fragments and receives the Echo Reply message from EUT2

  - step_id: 'TD_6LowPAN_FORMAT_04_step_05'
    type: verify
    node : IUT1
    description:
      - The data in the received echo reply message is identical to that sent in the echo request message

--- !testcase

testcase_id: TD_6LowPAN_FORMAT_05
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle uncompressed 6LowPAN multicast to all-nodes (16-bit link-local)
pre_conditions: 
  - Header compression is disabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use 16-bit short address
references: 'RFC 4944 5.1, 8'
sequence:
  - step_id: 'TD_6LowPAN_FORMAT_05_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to the link-local all-nodes multicast address (FF02::1) (ICMP payload = 4 bytes, total IPv6 size 52 bytes)

  - step_id: 'TD_6LowPAN_FORMAT_05_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends an uncompressed 6LowPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LowPAN_FORMAT_05_step_02'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “01000001”

  - step_id: 'TD_6LowPAN_FORMAT_05_step_03'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_FORMAT_05_step_04'
    type: check
    node : IUT2
    description:
      - EUT2 sends an uncompressed 6LowPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LowPAN_FORMAT_05_step_05'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “01000001”

  - step_id: 'TD_6LowPAN_FORMAT_05_step_06'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2

  - step_id: 'TD_6LowPAN_FORMAT_05_step_07'
    type: check
    node : IUT1
    description:
      - The data in the echo reply message is identical to that in the echo request message

--- !testcase

testcase_id: TD_6LowPAN_FORMAT_06
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle uncompressed 6LowPAN multicast to all-nodes (EUI-64 link-local)
pre_conditions: 
  - Header compression is disabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use EUI-64
references: 'RFC 4944 5.1, 8'
sequence:
  - step_id: 'TD_6LowPAN_FORMAT_06_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to the link-local all-nodes multicast address (FF02::1) (ICMP payload = 4 bytes, total IPv6 size 52 bytes)

  - step_id: 'TD_6LowPAN_FORMAT_06_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends an uncompressed 6LowPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LowPAN_FORMAT_06_step_02'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “01000001”

  - step_id: 'TD_6LowPAN_FORMAT_06_step_03'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_FORMAT_06_step_04'
    type: check
    node : IUT2
    description:
      - EUT2 sends an uncompressed 6LowPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LowPAN_FORMAT_06_step_05'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “01000001”

  - step_id: 'TD_6LowPAN_FORMAT_06_step_06'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2

  - step_id: 'TD_6LowPAN_FORMAT_06_step_07'
    type: check
    node : IUT1
    description:
      - The data in the echo reply message is identical to that in the echo request message

--- !testcase

testcase_id: TD_6LowPAN_FORMAT_07
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle uncompressed 6LowPAN packets (EUI-64 to 16-bit link-local)
pre_conditions: 
  - Header compression is disabled on both EUT1 and EUT2
  - EUT1 is configured to use EUI-64 and EUT2 is configured to use 16-bit short address
references: 'RFC 4944 5.1, 8'
sequence:
  - step_id: 'TD_6LowPAN_FORMAT_07_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes

  - step_id: 'TD_6LowPAN_FORMAT_07_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends an uncompressed 6LowPAN packet containing the Echo Request message to EUT2's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Source address is EUI-64 link-local
      - Destination address is 16 bit short link-local

  - step_id: 'TD_6LowPAN_FORMAT_07_step_02'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_FORMAT_07_step_03'
    type: check
    node : IUT2
    description:
      - EUT2 sends an uncompressed 6LowPAN packet containing the Echo Reply message to EUT1's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Source address is 16 bit short link-local
      - Destination address is EUI-64 link-local

  - step_id: 'TD_6LowPAN_FORMAT_07_step_04'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2

  - step_id: 'TD_6LowPAN_FORMAT_07_step_05'
    type: check
    node : IUT1
    description:
      - The data received in the echo reply message is identical to that sent in EUT1's echo request message

--- !testcase

testcase_id: TD_6LowPAN_FORMAT_08
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle uncompressed 6LowPAN packets (16-bit to EUI-64 link-local)
pre_conditions: 
  - Header compression is disabled on both EUT1 and EUT2
  - EUT1 is configured to use 16-bit short address and EUT2 is configured to use EUI-64
references: 'RFC 4944 5.1, 8'
sequence:
  - step_id: 'TD_6LowPAN_FORMAT_08_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes

  - step_id: 'TD_6LowPAN_FORMAT_08_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends an uncompressed 6LowPAN packet containing the Echo Request message to EUT2's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Source address is 16 bit short link-local
      - Destination address is EUI-64 link-local

  - step_id: 'TD_6LowPAN_FORMAT_08_step_02'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_FORMAT_08_step_03'
    type: check
    node : IUT2
    description:
      - EUT2 sends an uncompressed 6LowPAN packet containing the Echo Reply message to EUT1's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Source address is EUI-64 link-local
      - Destination address is 16 bit short link-local

  - step_id: 'TD_6LowPAN_FORMAT_08_step_04'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2

  - step_id: 'TD_6LowPAN_FORMAT_08_step_05'
    type: check
    node : IUT1
    description:
      - The data received in the echo reply message is identical to that sent in EUT1's echo request message

--- !testcase

testcase_id: TD_6LowPAN_HC_01
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle compressed 6LoWPAN packets (EUI-64 linklocal, hop limit=64)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use EUI-64
  - EUT1 and EUT2 are configured with a default hop limit of 64
references: 'RFC 6282 section 3'
sequence:
  - step_id: 'TD_6LowPAN_HC_01_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LowPAN_HC_01_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends a compressed 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LowPAN_HC_01_step_02'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_01_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_01_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LowPAN_HC_01_step_05'
    type: feature
    node : IUT1
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_01_step_06'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_HC_01_step_07'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LowPAN_HC_01_step_08'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_01_step_09'
    type: feature
    node : IUT2
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_01_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LowPAN_HC_01_step_11'
    type: feature
    node : IUT2
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_01_step_12'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2
Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LowPAN_HC_02
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle compressed 6LoWPAN packets (16-bit linklocal, hop limit=64)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use 16-bit short address
  - EUT1 and EUT2 are configured with a default hop limit of 64
references: 'RFC 6282 section 3'
sequence:
  - step_id: 'TD_6LowPAN_HC_02_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LowPAN_HC_02_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends a compressed 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LowPAN_HC_02_step_02'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_02_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_02_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LowPAN_HC_02_step_05'
    type: feature
    node : IUT1
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_02_step_06'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_HC_02_step_07'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LowPAN_HC_02_step_08'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_02_step_09'
    type: feature
    node : IUT2
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_02_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LowPAN_HC_02_step_11'
    type: feature
    node : IUT2
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_02_step_12'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2
Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LowPAN_HC_03
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle compressed 6LoWPAN packets (EUI-64 linklocal, hop limit=63)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use EUI-64
  - EUT1 and EUT2 are configured with a default hop limit of 63
references: 'RFC 6282 section 3'
sequence:
  - step_id: 'TD_6LowPAN_HC_03_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 63, no traffic class or flow label is being used

  - step_id: 'TD_6LowPAN_HC_03_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends a compressed 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LowPAN_HC_03_step_02'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_03_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_03_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 00 and the hop limit field is carried in-line

  - step_id: 'TD_6LowPAN_HC_03_step_05'
    type: feature
    node : IUT1
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_03_step_06'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_HC_03_step_07'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LowPAN_HC_03_step_08'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_03_step_09'
    type: feature
    node : IUT2
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_03_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 00 and the hop limit field is carried in-line

  - step_id: 'TD_6LowPAN_HC_03_step_11'
    type: feature
    node : IUT2
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_03_step_12'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2
Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LowPAN_HC_04
uri : none
configuration: Node to Node
objective: check that EUTs correctly handle compressed 6LoWPAN packets (16-bit linklocal, hop limit=63)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use 16-bit short address
  - EUT1 and EUT2 are configured with a default hop limit of 63
references: 'RFC 6282 section 3'
sequence:
  - step_id: 'TD_6LowPAN_HC_04_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 63, no traffic class or flow label is being used

  - step_id: 'TD_6LowPAN_HC_04_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends a compressed 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LowPAN_HC_04_step_02'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_04_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_04_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 00 and the hop limit field is carried in-line

  - step_id: 'TD_6LowPAN_HC_04_step_05'
    type: feature
    node : IUT1
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_04_step_06'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_HC_04_step_07'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LowPAN_HC_04_step_08'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_04_step_09'
    type: feature
    node : IUT2
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_04_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 00 and the hop limit field is carried in-line

  - step_id: 'TD_6LowPAN_HC_04_step_11'
    type: feature
    node : IUT2
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_04_step_12'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2
Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LowPAN_HC_05
uri : none
configuration: Host to 6LR
objective: check that EUTs correctly handle compressed UDP packets (EUI-64, server port 5683)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use EUI-64 address
  - A CoAP ping server is installed on port 5683 of the host
references: 'RFC 6282 4.3'
sequence:
  - step_id: 'TD_6LowPAN_HC_05_step_00'
    type: stimuli
    node : 6LR
    description:
      - 6LR initiates a CoAP Ping request to Host's CoAP Ping server

  - step_id: 'TD_6LowPAN_HC_05_step_01'
    type: check
    node : 6LR
    description:
      - 6LR sends a 6LoWPAN packet containing the CoAP Ping message to Host

  - step_id: 'TD_6LowPAN_HC_05_step_02'
    type: feature
    node : 6LR
    description:
      - NH is set, NHC is 111100x0, the source port is compressed to 8 bits (x=1) or uncompressed (x=0), the destination port is uncompressed 5683

  - step_id: 'TD_6LowPAN_HC_05_step_03'
    type: verify
    node : Host
    description:
      - Host receives the CoAP Ping message from 6LR

  - step_id: 'TD_6LowPAN_HC_05_step_04'
    type: check
    node : Host
    description:
      - Host sends a 6LoWPAN packet containing the CoAP Reset message to 6LR

  - step_id: 'TD_6LowPAN_HC_05_step_05'
    type: feature
    node : Host
    description:
      - NH is set, NHC is 1111000x, the source port is uncompressed 5683, the destination port is compressed to 8 bits (x=1) or uncompressed (x=0)

  - step_id: 'TD_6LowPAN_HC_05_step_06'
    type: verify
    node : 6LR
    description:
      - 6LR receives the CoAP Reset message from Host

Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)

--- !testcase

testcase_id: TD_6LowPAN_HC_06
uri : none
configuration: Host to 6LR
objective: check that EUTs correctly handle compressed UDP packets (16-bit, server port 5683)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use 16-bit address
  - A CoAP ping server is installed on port 5683 of the host
references: 'RFC 6282 4.3'
sequence:
  - step_id: 'TD_6LowPAN_HC_06_step_00'
    type: stimuli
    node : 6LR
    description:
      - 6LR initiates a CoAP Ping request to Host's CoAP Ping server

  - step_id: 'TD_6LowPAN_HC_06_step_01'
    type: check
    node : 6LR
    description:
      - 6LR sends a 6LoWPAN packet containing the CoAP Ping message to Host

  - step_id: 'TD_6LowPAN_HC_06_step_02'
    type: feature
    node : 6LR
    description:
      - NH is set, NHC is 111100x0, the source port is compressed to 8 bits (x=1) or uncompressed (x=0), the destination port is uncompressed 5683

  - step_id: 'TD_6LowPAN_HC_06_step_03'
    type: verify
    node : Host
    description:
      - Host receives the CoAP Ping message from 6LR

  - step_id: 'TD_6LowPAN_HC_06_step_04'
    type: check
    node : Host
    description:
      - Host sends a 6LoWPAN packet containing the CoAP Reset message to 6LR

  - step_id: 'TD_6LowPAN_HC_06_step_05'
    type: feature
    node : Host
    description:
      - NH is set, NHC is 1111000x, the source port is uncompressed 5683, the destination port is compressed to 8 bits (x=1) or uncompressed (x=0)

  - step_id: 'TD_6LowPAN_HC_06_step_06'
    type: verify
    node : 6LR
    description:
      - 6LR receives the CoAP Reset message from Host

Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)

--- !testcase

testcase_id: TD_6LowPAN_HC_07
uri : none
configuration: Host to 6LR
objective: check that EUTs correctly handle compressed UDP packets (EUI-64, server port 61616)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use EUI-64 address
  - A CoAP ping server is installed on port 61616 of the host
references: 'RFC 6282 4.3'
sequence:
  - step_id: 'TD_6LowPAN_HC_07_step_00'
    type: stimuli
    node : 6LR
    description:
      - 6LR initiates a CoAP Ping request to Host's CoAP Ping server

  - step_id: 'TD_6LowPAN_HC_07_step_01'
    type: check
    node : 6LR
    description:
      - 6LR sends a 6LoWPAN packet containing the CoAP Ping message to Host

  - step_id: 'TD_6LowPAN_HC_07_step_02'
    type: feature
    node : 6LR
    description:
      - NH is set, NHC is 111100x1, the destination port is compressed to 4 bits of 0000 (x=1) or 8 bits of 0xb0 (x=0)

  - step_id: 'TD_6LowPAN_HC_07_step_03'
    type: verify
    node : Host
    description:
      - Host receives the CoAP Ping message from 6LR

  - step_id: 'TD_6LowPAN_HC_07_step_04'
    type: check
    node : Host
    description:
      - Host sends a 6LoWPAN packet containing the CoAP Reset message to 6LR

  - step_id: 'TD_6LowPAN_HC_07_step_05'
    type: feature
    node : Host
    description:
      - NH is set, NHC is 1111001x, the source port is compressed to 4 bits of 0000 (x=1) or 8 bits of 0xb0 (x=0)

  - step_id: 'TD_6LowPAN_HC_07_step_06'
    type: verify
    node : 6LR
    description:
      - 6LR receives the CoAP Reset message from Host

Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)

--- !testcase

testcase_id: TD_6LowPAN_HC_08
uri : none
configuration: Host to 6LR
objective: check that EUTs correctly handle compressed UDP packets (16-bit, server port 61616)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use 16-bit address
  - A CoAP ping server is installed on port 61616 of the host
references: 'RFC 6282 4.3'
sequence:
  - step_id: 'TD_6LowPAN_HC_08_step_00'
    type: stimuli
    node : 6LR
    description:
      - 6LR initiates a CoAP Ping request to Host's CoAP Ping server

  - step_id: 'TD_6LowPAN_HC_08_step_01'
    type: check
    node : 6LR
    description:
      - 6LR sends a 6LoWPAN packet containing the CoAP Ping message to Host

  - step_id: 'TD_6LowPAN_HC_08_step_02'
    type: feature
    node : 6LR
    description:
      - NH is set, NHC is 111100x1, the destination port is compressed to 4 bits of 0000 (x=1) or 8 bits of 0xb0 (x=0)

  - step_id: 'TD_6LowPAN_HC_08_step_03'
    type: verify
    node : Host
    description:
      - Host receives the CoAP Ping message from 6LR

  - step_id: 'TD_6LowPAN_HC_08_step_04'
    type: check
    node : Host
    description:
      - Host sends a 6LoWPAN packet containing the CoAP Reset message to 6LR

  - step_id: 'TD_6LowPAN_HC_08_step_05'
    type: feature
    node : Host
    description:
      - NH is set, NHC is 1111001x, the source port is compressed to 4 bits of 0000 (x=1) or 8 bits of 0xb0 (x=0)

  - step_id: 'TD_6LowPAN_HC_08_step_06'
    type: verify
    node : 6LR
    description:
      - 6LR receives the CoAP Reset message from Host

Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)

--- !testcase

testcase_id: TD_6LowPAN_HC_09
uri : none
configuration: Node to node
objective: check that EUTs correctly handle compressed 6LoWPAN packets (EUI-64 to 16- bit link-local, hop limit=64)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 is configured to use EUI-64 and EUT2 is configured to use 16-bit short address
references: 'RFC 6282 section 3'
sequence:
  - step_id: 'TD_6LowPAN_HC_09_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LowPAN_HC_09_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends a compressed 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LowPAN_HC_09_step_02'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_09_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_09_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LowPAN_HC_09_step_05'
    type: feature
    node : IUT1
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_09_step_06'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_HC_09_step_07'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LowPAN_HC_09_step_08'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_09_step_09'
    type: feature
    node : IUT2
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_09_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LowPAN_HC_09_step_11'
    type: feature
    node : IUT2
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_09_step_12'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2

Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LowPAN_HC_10
uri : none
configuration: Node to node
objective: check that EUTs correctly handle compressed 6LoWPAN packets (EUI-64 to 16- bit link-local, hop limit=64)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 is configured to use EUI-64 and EUT2 is configured to use 16-bit short address
references: 'RFC 6282 section 3'
sequence:
  - step_id: 'TD_6LowPAN_HC_10_step_00'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LowPAN_HC_10_step_01'
    type: check
    node : IUT1
    description:
      - EUT1 sends a compressed 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LowPAN_HC_10_step_02'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_10_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_10_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LowPAN_HC_10_step_05'
    type: feature
    node : IUT1
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_10_step_06'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LowPAN_HC_10_step_07'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LowPAN_HC_10_step_08'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LowPAN_HC_10_step_09'
    type: feature
    node : IUT2
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LowPAN_HC_10_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LowPAN_HC_10_step_11'
    type: feature
    node : IUT2
    description:
      - In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11

  - step_id: 'TD_6LowPAN_HC_10_step_12'
    type: verify
    node : IUT1
    description:
      - EUT1 receives the Echo Reply message from EUT2

Notes:
  - The feature tests check that best compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LoWPAN_ND_01
uri : none
configuration: Host to 6LR
objective: check that a host is able to register its global IPv6 address (EUI-64)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use EUI-64 address
references: 'RFC 6775 10.2'
sequence:
  - step_id: 'TD_6LoWPAN_ND_01_step_00'
    type: stimuli
    node : Host
    description:
      - Initialize the network interface of the Host

  - step_id: 'TD_6LoWPAN_ND_01_step_01'
    type: check
    node : Host
    description:
      - The Host sends a Router Solicitation to all-routers multicast address with SLLAO (EUI-64). Source = link local based on EUI-64

  - step_id: 'TD_6LoWPAN_ND_01_step_02'
    type: verify
    node : 6LR
    description:
      - The Router receives the Router Solicitation from the host.

  - step_id: 'TD_6LoWPAN_ND_01_step_03'
    type: check
    node : 6LR
    description:
      - The Router sends a unicast Router Advertisement containing PIO and optionally 6COs to the host.
      - Link local addresses are used.
      - The L bit is not set.

  - step_id: 'TD_6LoWPAN_ND_01_step_04'
    type: verify
    node : Host
    description:
      - The host receives the Router Advertisement from the router

  - step_id: 'TD_6LoWPAN_ND_01_step_05'
    type: check
    node : Host
    description:
      - The host configures its tentative global IPv6 address based on the PIO information in RA from the Router (EUI-64)

  - step_id: 'TD_6LoWPAN_ND_01_step_06'
    type: check
    node : Host
    description:
      - The host registers its tentative address by sending a unicast Neighbor Solicitation containing ARO and SLLAO. Source = GP64

  - step_id: 'TD_6LoWPAN_ND_01_step_07'
    type: verify
    node : 6LR
    description:
      - The Router receives the Neighbor Solicitation from the host.

  - step_id: 'TD_6LoWPAN_ND_01_step_08'
    type: check
    node : 6LR
    description:
      - The Router sends a Neighbor Advertisement with Status set to 0 (Dest = GP64)

  - step_id: 'TD_6LoWPAN_ND_01_step_09'
    type: verify
    node : Host
    description:
      - The host updates the status of the tentative address

  - step_id: 'TD_6LoWPAN_ND_01_step_10'
    type: stimuli
    node : 6LR
    description:
      - The Router initiates an echo request to the Host's new global address, using its own global address as the source
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LoWPAN_ND_01_step_11'
    type: check
    node : 6LR
    description:
      - The Router sends a 6LoWPAN packet containing the Echo Request message to the Host

  - step_id: 'TD_6LoWPAN_ND_01_step_12'
    type: check
    node : 6LR
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_01_step_13'
    type: feature
    node : 6LR
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_01_step_14'
    type: feature
    node : 6LR
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_01_step_15'
    type: verify
    node : Host
    description:
      - The Host receives the Echo Request message from the Router

  - step_id: 'TD_6LoWPAN_ND_01_step_16'
    type: check
    node : Host
    description:
      - The Host sends a 6LoWPAN packet containing the Echo Reply message to the Router

  - step_id: 'TD_6LoWPAN_ND_01_step_17'
    type: check
    node : Host
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_01_step_18'
    type: feature
    node : Host
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_01_step_19'
    type: feature
    node : Host
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_01_step_20'
    type: verify
    node : 6LR
    description:
      - The Router receives the Echo Reply message from the Host

Notes:
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LoWPAN_ND_02
uri : none
configuration: Host to 6LR
objective: check that a host is able to register its global IPv6 address (16-bit)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use 16 bit short address
references: 'RFC 6775 10.2'
sequence:
  - step_id: 'TD_6LoWPAN_ND_02_step_00'
    type: stimuli
    node : Host
    description:
      - Initialize the network interface of the Host

  - step_id: 'TD_6LoWPAN_ND_02_step_01'
    type: check
    node : Host
    description:
      - The Host sends a Router Solicitation to all-routers multicast address with SLLAO (EUI-64). Source = link local based on EUI-64

  - step_id: 'TD_6LoWPAN_ND_02_step_02'
    type: verify
    node : 6LR
    description:
      - The Router receives the Router Solicitation from the host.

  - step_id: 'TD_6LoWPAN_ND_02_step_03'
    type: check
    node : 6LR
    description:
      - The Router sends a unicast Router Advertisement containing PIO and optionally 6COs to the host.
      - Link local addresses are used.
      - The L bit is not set.

  - step_id: 'TD_6LoWPAN_ND_02_step_04'
    type: verify
    node : Host
    description:
      - The host receives the Router Advertisement from the router

  - step_id: 'TD_6LoWPAN_ND_02_step_05'
    type: check
    node : Host
    description:
      - The host configures its tentative global IPv6 address based on the PIO information in RA from the Router (16-bit)

  - step_id: 'TD_6LoWPAN_ND_02_step_06'
    type: check
    node : Host
    description:
      - The host registers its tentative address by sending a unicast Neighbor Solicitation containing ARO and SLLAO. Source = GP16

  - step_id: 'TD_6LoWPAN_ND_02_step_07'
    type: verify
    node : 6LR
    description:
      - The Router receives the Neighbor Solicitation from the host.

  - step_id: 'TD_6LoWPAN_ND_02_step_08'
    type: check
    node : 6LR
    description:
      - The Router sends a Neighbor Advertisement with Status set to 0 (Dest = GP16)

  - step_id: 'TD_6LoWPAN_ND_02_step_09'
    type: verify
    node : Host
    description:
      - The host updates the status of the tentative address

  - step_id: 'TD_6LoWPAN_ND_02_step_10'
    type: stimuli
    node : 6LR
    description:
      - The Router initiates an echo request to the Host's new global address, using its own global address as the source
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LoWPAN_ND_02_step_11'
    type: check
    node : 6LR
    description:
      - The Router sends a 6LoWPAN packet containing the Echo Request message to the Host

  - step_id: 'TD_6LoWPAN_ND_02_step_12'
    type: check
    node : 6LR
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_02_step_13'
    type: feature
    node : 6LR
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_02_step_14'
    type: feature
    node : 6LR
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_02_step_15'
    type: verify
    node : Host
    description:
      - The Host receives the Echo Request message from the Router

  - step_id: 'TD_6LoWPAN_ND_02_step_16'
    type: check
    node : Host
    description:
      - The Host sends a 6LoWPAN packet containing the Echo Reply message to the Router

  - step_id: 'TD_6LoWPAN_ND_02_step_17'
    type: check
    node : Host
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_02_step_18'
    type: feature
    node : Host
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_02_step_19'
    type: feature
    node : Host
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_02_step_20'
    type: verify
    node : 6LR
    description:
      - The Router receives the Echo Reply message from the Host

Notes:
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LoWPAN_ND_03
uri : none
configuration: Host to 6LR
objective: check Host NUD behavior
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use EUI-64 address
  - Host is up and registered its global address with the Router
references: 'RFC 6775 5.5'
sequence:
  - step_id: 'TD_6LoWPAN_ND_03_step_00'
    type: stimuli
    node : Host
    description:
      - Host sends a sequence of echo requests to 2001:db8::1

  - step_id: 'TD_6LoWPAN_ND_03_step_01'
    type: verify
    node : Host
    description:
      - Host sends a unicast NS message to the 6LR to perform NUD

--- !testcase

testcase_id: TD_6LoWPAN_ND_04
uri : none
configuration: Host to 6LR
objective: check 6LR NUD behavior (ICMP version)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use EUI-64 address
  - Host is up and registered its global address with the Router
references: 'RFC 6775 5.5'
sequence:
  - step_id: 'TD_6LoWPAN_ND_04_step_00'
    type: stimuli
    node : 6LR
    description:
      - 6LR sends a sequence of echo requests to Host

  - step_id: 'TD_6LoWPAN_ND_04_step_01'
    type: stimuli
    node : Host
    description:
      - After 10 seconds, echo reply function is disabled on host

  - step_id: 'TD_6LoWPAN_ND_04_step_01'
    type: verify
    node : 6LR
    description:
      - 6LR sends a unicast NS message to the host to perform NUD

Notes:
  - Optional, as not all hosts allow disabling echo reply function

--- !testcase

testcase_id: TD_6LoWPAN_ND_05
uri : none
configuration: Host to 6LR
objective: check 6LR NUD behavior (UDP version)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use EUI-64 address
  - A CoAP ping server is installed on port 5683 of the host
  - Host is up and registered its global address with the Router
references: 'RFC 6775 5.5'
sequence:
  - step_id: 'TD_6LoWPAN_ND_05_step_00'
    type: stimuli
    node : 6LR
    description:
      - 6LR sends a sequence of CoAP pings to Host

  - step_id: 'TD_6LoWPAN_ND_05_step_01'
    type: stimuli
    node : Host
    description:
      - After 10 seconds, CoAP server function is disabled on host

  - step_id: 'TD_6LoWPAN_ND_05_step_01'
    type: verify
    node : 6LR
    description:
      - 6LR sends a unicast NS message to the host to perform NUD

Notes:
  - Optional, as not all hosts allow disabling CoAP server function

--- !testcase

testcase_id: TD_6LoWPAN_ND_06
uri : none
configuration: Host to 6LR
objective: check host behavior under multiple prefixes (EUI-64)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use EUI-64 address
  - Router is configured with multiple prefixes
references: 'RFC 4861 3.1'
sequence:
  - step_id: 'TD_6LoWPAN_ND_06_step_00'
    type: stimuli
    node : Host
    description:
      - Initialize the network interface of the Host

  - step_id: 'TD_6LoWPAN_ND_06_step_01'
    type: check
    node : Host
    description:
      - The Host sends a Router Solicitation to all-routers multicast address with SLLAO (EUI-64). Source = link local based on EUI-64

  - step_id: 'TD_6LoWPAN_ND_06_step_02'
    type: verify
    node : 6LR
    description:
      - The Router receives the Router Solicitation from the host.

  - step_id: 'TD_6LoWPAN_ND_06_step_03'
    type: check
    node : 6LR
    description:
      - The Router sends a unicast Router Advertisement containing PIO with multiple prefixes and optionally 6COs to the host.
      - Link local addresses are used.
      - The L bit is not set.

  - step_id: 'TD_6LoWPAN_ND_06_step_04'
    type: verify
    node : Host
    description:
      - The host receives the Router Advertisement from the router

  - step_id: 'TD_6LoWPAN_ND_06_step_05'
    type: check
    node : Host
    description:
      - The host configures a number of tentative global IPv6 address based on the PIO information in RA from the Router (EUI-64)

  - step_id: 'TD_6LoWPAN_ND_06_step_06'
    type: check
    node : Host
    description:
      - The host registers its tentative addresses by sending unicast Neighbor Solicitations containing ARO and SLLAO. Source = GP64

  - step_id: 'TD_6LoWPAN_ND_06_step_07'
    type: verify
    node : 6LR
    description:
      - The Router receives the Neighbor Solicitation from the host.

  - step_id: 'TD_6LoWPAN_ND_06_step_08'
    type: check
    node : 6LR
    description:
      - The Router sends a Neighbor Advertisement with Status set to 0 (Dest = GP64)

  - step_id: 'TD_6LoWPAN_ND_06_step_09'
    type: verify
    node : Host
    description:
      - The host updates the status of the tentative address

  - step_id: 'TD_6LoWPAN_ND_06_step_10'
    type: stimuli
    node : 6LR
    description:
      - The Router initiates an echo request to one of the Host's new global addresses, using the appropriate own global address as the source
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LoWPAN_ND_06_step_11'
    type: check
    node : 6LR
    description:
      - The Router sends a 6LoWPAN packet containing the Echo Request message to the Host

  - step_id: 'TD_6LoWPAN_ND_06_step_12'
    type: check
    node : 6LR
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_06_step_13'
    type: feature
    node : 6LR
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_06_step_14'
    type: feature
    node : 6LR
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_06_step_15'
    type: verify
    node : Host
    description:
      - The Host receives the Echo Request message from the Router

  - step_id: 'TD_6LoWPAN_ND_06_step_16'
    type: check
    node : Host
    description:
      - The Host sends a 6LoWPAN packet containing the Echo Reply message to the Router

  - step_id: 'TD_6LoWPAN_ND_06_step_17'
    type: check
    node : Host
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_06_step_18'
    type: feature
    node : Host
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_06_step_19'
    type: feature
    node : Host
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_06_step_20'
    type: verify
    node : 6LR
    description:
      - The Router receives the Echo Reply message from the Host

Notes:
  - Optional, as not all 6lrs and hosts allow multiple prefixes
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LoWPAN_ND_07
uri : none
configuration: Host to 6LR
objective: check host behavior under multiple prefixes (EUI-64)
pre_conditions: 
  - Header compression is enabled on both Host and Router
  - Host is configured to use 16 bit short address
  - Router is configured with multiple prefixes
references: 'RFC 4861 3.1'
sequence:
  - step_id: 'TD_6LoWPAN_ND_07_step_00'
    type: stimuli
    node : Host
    description:
      - Initialize the network interface of the Host

  - step_id: 'TD_6LoWPAN_ND_07_step_01'
    type: check
    node : Host
    description:
      - The Host sends a Router Solicitation to all-routers multicast address with SLLAO (EUI-64). Source = link local based on EUI-64

  - step_id: 'TD_6LoWPAN_ND_07_step_02'
    type: verify
    node : 6LR
    description:
      - The Router receives the Router Solicitation from the host.

  - step_id: 'TD_6LoWPAN_ND_07_step_03'
    type: check
    node : 6LR
    description:
      - The Router sends a unicast Router Advertisement containing PIO with multiple prefixes and optionally 6COs to the host.
      - Link local addresses are used.
      - The L bit is not set.

  - step_id: 'TD_6LoWPAN_ND_07_step_04'
    type: verify
    node : Host
    description:
      - The host receives the Router Advertisement from the router

  - step_id: 'TD_6LoWPAN_ND_07_step_05'
    type: check
    node : Host
    description:
      - The host configures a number of tentative global IPv6 address based on the PIO information in RA from the Router (16-bit)

  - step_id: 'TD_6LoWPAN_ND_07_step_06'
    type: check
    node : Host
    description:
      - The host registers its tentative addresses by sending unicast Neighbor Solicitations containing ARO and SLLAO. Source = GP16

  - step_id: 'TD_6LoWPAN_ND_07_step_07'
    type: verify
    node : 6LR
    description:
      - The Router receives the Neighbor Solicitation from the host.

  - step_id: 'TD_6LoWPAN_ND_07_step_08'
    type: check
    node : 6LR
    description:
      - The Router sends a Neighbor Advertisement with Status set to 0 (Dest = GP16)

  - step_id: 'TD_6LoWPAN_ND_07_step_09'
    type: verify
    node : Host
    description:
      - The host updates the status of the tentative addresses

  - step_id: 'TD_6LoWPAN_ND_07_step_10'
    type: stimuli
    node : 6LR
    description:
      - The Router initiates an echo request to one of the Host's new global addresses, using the appropriate own global address as the source
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LoWPAN_ND_07_step_11'
    type: check
    node : 6LR
    description:
      - The Router sends a 6LoWPAN packet containing the Echo Request message to the Host

  - step_id: 'TD_6LoWPAN_ND_07_step_12'
    type: check
    node : 6LR
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_07_step_13'
    type: feature
    node : 6LR
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_07_step_14'
    type: feature
    node : 6LR
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_07_step_15'
    type: verify
    node : Host
    description:
      - The Host receives the Echo Request message from the Router

  - step_id: 'TD_6LoWPAN_ND_07_step_16'
    type: check
    node : Host
    description:
      - The Host sends a 6LoWPAN packet containing the Echo Reply message to the Router

  - step_id: 'TD_6LoWPAN_ND_07_step_17'
    type: check
    node : Host
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_07_step_18'
    type: feature
    node : Host
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_07_step_19'
    type: feature
    node : Host
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_07_step_20'
    type: verify
    node : 6LR
    description:
      - The Router receives the Echo Reply message from the Host

Notes:
  - Optional, as not all 6lrs and hosts allow multiple prefixes
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LoWPAN_ND_HC_01
uri : none
configuration: Host to 6LR
objective: check that EUTs make use of context 0 (EUI-64)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use EUI-64
  - EUT1 and EUT2 are configured with a default hop limit of 64
references: 'RFC 6775 5.4, RFC 6282 3.1.1'
sequence:
  - step_id: 'TD_6LoWPAN_ND_HC_01_step_00'
    type: stimuli
    node : Host
    description:
      - Host is set up with 6LR and receives context 0 for the global prefix

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_01'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's GP64 address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_02'
    type: check
    node : IUT1
    description:
      - EUT1 sends a 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_05'
    type: feature
    node : IUT1
    description:
      - The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=01/11)

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_06'
    type: feature
    node : IUT1
    description:
      - The context identifier extension is not present (CID = 0)

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_07'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_08'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_09'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_11'
    type: feature
    node : IUT2
    description:
      - The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=01/11)

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_12'
    type: feature
    node : IUT2
    description:
      - The context identifier extension is not present (CID = 0)

  - step_id: 'TD_6LoWPAN_ND_HC_01_step_13'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

Notes:
  - The feature tests check that good compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LoWPAN_ND_HC_02
uri : none
configuration: Host to 6LR
objective: check that EUTs make use of context 0 (16-bit)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use 16-bit short address
  - EUT1 and EUT2 are configured with a default hop limit of 64
references: 'RFC 6775 5.4, RFC 6282 3.1.1'
sequence:
  - step_id: 'TD_6LoWPAN_ND_HC_02_step_00'
    type: stimuli
    node : Host
    description:
      - Host is set up with 6LR and receives context 0 for the global prefix

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_01'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's GP16 address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_02'
    type: check
    node : IUT1
    description:
      - EUT1 sends a 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_05'
    type: feature
    node : IUT1
    description:
      - The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=10/11)

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_06'
    type: feature
    node : IUT1
    description:
      - The context identifier extension is not present (CID = 0)

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_07'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_08'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_09'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_11'
    type: feature
    node : IUT2
    description:
      - The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=10/11)

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_12'
    type: feature
    node : IUT2
    description:
      - The context identifier extension is not present (CID = 0)

  - step_id: 'TD_6LoWPAN_ND_HC_02_step_13'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

Notes:
  - The feature tests check that good compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LoWPAN_ND_HC_03
uri : none
configuration: Host to 6LR
objective: check that EUTs make use of context ≠ 0 (EUI-64)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use EUI-64
  - EUT1 and EUT2 are configured with a default hop limit of 64
references: 'RFC 6775 5.4, RFC 6282 3.1.2'
sequence:
  - step_id: 'TD_6LoWPAN_ND_HC_03_step_00'
    type: stimuli
    node : Host
    description:
      - Host is set up with 6LR and receives context ≠ 0 for the global prefix

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_01'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's GP64 address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_02'
    type: check
    node : IUT1
    description:
      - EUT1 sends a 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_05'
    type: feature
    node : IUT1
    description:
      - The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=01/11)

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_06'
    type: check
    node : IUT1
    description:
      - A Context Identifier Extension (CID) is used for this

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_07'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_08'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_09'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_11'
    type: feature
    node : IUT2
    description:
      - The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=01/11)

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_12'
    type: check
    node : IUT2
    description:
      - A Context Identifier Extension (CID) is used for this

  - step_id: 'TD_6LoWPAN_ND_HC_03_step_13'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

Notes:
  - The feature tests check that good compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.

--- !testcase

testcase_id: TD_6LoWPAN_ND_HC_04
uri : none
configuration: Host to 6LR
objective: check that EUTs make use of context ≠ 0 (16-bit)
pre_conditions: 
  - Header compression is enabled on both EUT1 and EUT2
  - EUT1 and EUT2 are configured to use 16-bit short address
  - EUT1 and EUT2 are configured with a default hop limit of 64
references: 'RFC 6775 5.4, RFC 6282 3.1.2'
sequence:
  - step_id: 'TD_6LoWPAN_ND_HC_04_step_00'
    type: stimuli
    node : Host
    description:
      - Host is set up with 6LR and receives context ≠ 0 for the global prefix

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_01'
    type: stimuli
    node : IUT1
    description:
      - EUT1 initiates an echo request to EUT2's GP16 address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_02'
    type: check
    node : IUT1
    description:
      - EUT1 sends a 6LoWPAN packet containing the Echo Request message to EUT2

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_03'
    type: feature
    node : IUT1
    description:
      - In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_04'
    type: feature
    node : IUT1
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_05'
    type: feature
    node : IUT1
    description:
      - The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=10/11)

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_06'
    type: check
    node : IUT1
    description:
      - A Context Identifier Extension (CID) is used for this

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_07'
    type: check
    node : IUT1
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_08'
    type: verify
    node : IUT2
    description:
      - EUT2 receives the Echo Request message from EUT1

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_09'
    type: check
    node : IUT2
    description:
      - EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_10'
    type: feature
    node : IUT2
    description:
      - In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_11'
    type: feature
    node : IUT2
    description:
      - The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=10/11)

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_12'
    type: check
    node : IUT2
    description:
      - A Context Identifier Extension (CID) is used for this

  - step_id: 'TD_6LoWPAN_ND_HC_04_step_13'
    type: check
    node : IUT2
    description:
      - Dispatch value in 6LowPAN packet is “011TFxHL”

Notes:
  - The feature tests check that good compression is used (but this is not a requirement for interoperability)
  - The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.