# -*- coding: utf-8 -*-
--- !testcase
testcase_id: TD_COAP_CORE_01_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_01_v01
configuration: COAP_CFG_01_v01
objective: Perform GET transaction(CON mode)
pre_conditions: Server offers the resource /test with resource content is not empty that handles GET with an arbitrary payload
references: '[COAP] 5.8.1, 1.2, 2.1, 2.2, 3.1'
sequence:
  - step_id: 'TD_COAP_CORE_01_v01_step_01'
    type: stimuli
    node : coap_client
    description:
      - 'Client is requested to send a GET request with'
      - - Type = 0(CON)
        - Code = 1(GET)

  - step_id: TD_COAP_CORE_01_v01_step_02
    type: check
    description:
      - 'The request sent by the client contains'
      - - Type=0 and Code=1
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)
        - UTEST Uri-Path option "test"

  - step_id: TD_COAP_CORE_01_v01_step_03
    type: check
    description:
        - 'Server sends response containing'
        - - Code = 2.05(Content)
          - Message ID = CMID, Token = CTOK
          - Content-format option
          - Non-empty Payload

  - step_id: TD_COAP_CORE_01_v01_step_04
    type: verify
    node: coap_client
    description:
        - 'Client displays the received information'

--- !testcase

testcase_id : TD_COAP_CORE_02_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_02_v01
objective: Perform DELETE transaction (CON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 5.8.4, 1.2, 2.1, 2.2, 3.1"
pre_conditions: Server offers a /test resource that handles DELETE
sequence:

  - step_id : TD_COAP_CORE_02_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - 'Client is requested to send a DELETE request with:'
      - - Type = 0 (CON)
        - Code = 4 (DELETE)

  - step_id : TD_COAP_CORE_02_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=0 and Code=4
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)
        - Uri-Path option "test"

  - step_id : TD_COAP_CORE_02_v01_step_03
    type : check
    description:
      - 'Server sends response containing:'
      - - Code = 2.02 (Deleted)
        - Message ID = CMID, Token = CTOK
        - Content-format option if payload non-empty
        - Empty or non-empty Payload

  - step_id : TD_COAP_CORE_02_v01_step_04
    type : verify
    node : coap_client
    description:
        - 'Client displays the received information'

--- !testcase

testcase_id : TD_COAP_CORE_03_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_03_v01
objective: Perform PUT transaction (CON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 5.8.3, 1.2, 2.1, 2.2, 3.1"
pre_conditions: Server offers already available resource /test or accepts creation of new
  resource on /test that handles PUT
sequence:

- step_id : TD_COAP_CORE_03_v01_step_01
  type : stimuli
  node : coap_client
  description:
    - 'Client is requested to send a PUT request with:'
    - - Type = 0 (CON)
      - Code = 3 (PUT)
      - Content-format option
      - Empty or non-empty Payload

- step_id : TD_COAP_CORE_03_v01_step_02
  type : check
  description:
    - 'The request sent by the client contains:'
    - - Type=0 and Code=3
      - Client-generated Message ID (➔ CMID)
      - Client-generated Token (➔ CTOK)
      - Uri-Path option "test"


- step_id : TD_COAP_CORE_03_v01_step_03
  type : verify
  node : coap_client
  description:
    - Server displays received information

- step_id : TD_COAP_CORE_03_v01_step_04
  type : check
  description:
    - 'Server sends response containing:'
    - - Code = 2.04 (Changed) or 2.01 (Created)
      - Message ID = CMID, Token = CTOK
      - Content-format option if payload non-empty
      - Empty or non-empty Payload


- step_id : TD_COAP_CORE_03_v01_step_05
  type : verify
  node : coap_client
  description:
    - 'Client displays the received response'

--- !testcase


testcase_id : TD_COAP_CORE_04_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_04_v01
objective: Perform POST transaction (CON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 5.8.2, 1.2, 2.1, 2.2, 3.1"
pre_conditions: Server accepts POST requet on /test
sequence:

  - step_id : TD_COAP_CORE_04_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - 'Client is requested to send a POST request with:'
      - - Type = 0 (CON)
        - Code = 2 (PUT)
        - Content-format option
        - Empty or non-empty Payload

  - step_id : TD_COAP_CORE_04_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=0 and Code=2
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)

  - step_id : TD_COAP_CORE_04_v01_step_03
    type : verify
    node : coap_client
    description:
      - Server displays received information

  - step_id : TD_COAP_CORE_04_v01_step_04
    type : check
    description:
      - 'Server sends response containing:'
      - - Code = 2.04 (Changed) or 2.01 (Created)
        - Message ID = CMID, Token = CTOK
        - Content-format option
        - Zero or more Location-path option
        - Empty or non-empty Payload

  - step_id : TD_COAP_CORE_04_v01_step_05
    type : verify
    node : coap_client
    description:
      - 'Client displays the received response'

--- !testcase

testcase_id : TD_COAP_CORE_05_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_05_v01
objective: Perform GET transaction (NON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 5.8.1, 5.2.3"
pre_conditions: Server offers a /test resource with resource content is not empty that handles GET
sequence:

  - step_id : TD_COAP_CORE_05_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - 'Client is requested to send a GET request with:'
      - - Type = 1 (NON)
        - Code = 1 (GET)

  - step_id : TD_COAP_CORE_05_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=1 and Code=4
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)

  - step_id : TD_COAP_CORE_05_v01_step_03
    type : check
    description:
      - 'Server sends response containing:'
      - - Type=1 (NON)
        - Code = 2.05 (Content)
        - Server-generated Message ID (➔ SMID)
        - Token = CTOK
        - Content-format option

  - step_id : TD_COAP_CORE_05_v01_step_04
    type : verify
    node : coap_client
    description:
      - 'Client displays the received response'

--- !testcase

testcase_id : TD_COAP_CORE_06_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_06_v01
objective: Perform DELETE transaction (NON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 5.8.4, 5.2.3"
pre_conditions: Server offers a /test resource that handles DELETE
sequence:

  - step_id : TD_COAP_CORE_06_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - 'Client is requested to send a DELETE request with:'
      - - Type = 1 (NON)
        - Code = 4 (DELETE)

  - step_id : TD_COAP_CORE_06_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=1 and Code=4
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)

  - step_id : TD_COAP_CORE_06_v01_step_03
    type : check
    description:
      - 'Server sends response containing:'
      - - Type=1 (NON)
        - Code = 2.02 (Delete)
        - Server-generated Message ID (➔ SMID)
        - Token = CTOK
        - Empty or non-empty Payload
        - Content-format option if payload non-empty

  - step_id : TD_COAP_CORE_06_v01_step_04
    type : verify
    node : coap_client
    description:
      - 'Client displays the received response'

--- !testcase

testcase_id : TD_COAP_CORE_07_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_07_v01
objective: Perform PUT transaction (NON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 5.8.3, 5.2.3"
pre_conditions: Server offers a /test resource that handles PUT
sequence:

  - step_id : TD_COAP_CORE_07_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - 'Client is requested to send a PUT request with:'
      - - Type = 1 (NON)
        - Code = 3 (PUT)
        - An arbitrary payload
        - Content-format option

  - step_id : TD_COAP_CORE_07_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=1 and Code=3
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)

  - step_id : TD_COAP_CORE_07_v01_step_03
    type : verify
    node : coap_client
    description:
      - 'Server displays the received response'

  - step_id : TD_COAP_CORE_07_v01_step_04
    type : check
    description:
      - 'Server sends response containing:'
      - - Type=1 (NON)
        - Code=2.04(Changed) or 2.01 (Created)
        - Server-generated Message ID (➔ SMID)
        - Token = CTOK
        - Content-format option if payload non-empty
        - Empty or non-empty Payload

  - step_id : TD_COAP_CORE_07_v01_step_05
    type : verify
    node : coap_client
    description:
      - 'Client displays the received response'

--- !testcase

testcase_id : TD_COAP_CORE_08_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_08_v01
objective: Perform POST transaction (NON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 5.8.2, 5.2.3"
pre_conditions: Server accepts POST request on /test
sequence:

  - step_id : TD_COAP_CORE_08_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - 'Client is requested to send a POST request with:'
      - - Type = 1 (NON)
        - Code = 2 (POST)
        - An arbitrary payload
        - Content-format option

  - step_id : TD_COAP_CORE_08_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=1 and Code=2
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)
        - An arbitrary payload
        - Content-format option

  - step_id : TD_COAP_CORE_08_v01_step_03
    type : verify
    node : coap_client
    description:
      - 'Server displays the received response'

  - step_id : TD_COAP_CORE_08_v01_step_04
    type : check
    description:
      - 'Server sends response containing:'
      - - Type=1 (NON)
        - Code=2.01(Created) or 2.04 (Changed)
        - Server-generated Message ID (➔ SMID)
        - Token = CTOK
        - Zero or more Location-path options
        - Content-format option if payload non-empty
        - Empty or non-empty Payload

  - step_id : TD_COAP_CORE_08_v01_step_05
    type : verify
    node : coap_client
    description:
      - 'Client displays the received response'

--- !testcase

testcase_id : TD_COAP_CORE_09_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_09_v01
objective: Perform GET transaction with separate response(CON mode, no piggyback)
configuration: COAP_CFG_01_v01
references: "[COAP] 5.8.1, 5.2.2"
pre_conditions: Server offers a resource /separate which is not served immediately and which therefore is not acknowledged in a piggybacked way
sequence:

  - step_id : TD_COAP_CORE_09_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - "Client is requested to send a confirmable GET request to server's resource"

  - step_id : TD_COAP_CORE_09_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=0 (CON)
        - Code=1 (GET)
        - Client-generated Message ID (➔ CMID)

  - step_id : TD_COAP_CORE_09_v01_step_03
    type : check
    description:
      - 'Server sends response containing:'
      - - Type=2 (ACK)
        - Code=0
        - Message ID = CMID
        - Empty Payload

  - step_id : TD_COAP_CORE_09_v01_step_04
    type : check
    description:
      - 'Server sends response containing:'
      - - Type=0 (CON)
        - Code=2.05(Content)
        - Server-generated Message ID (➔ SMID)
        - Token = CTOK
        - Content-format option
        - Non-empty Payload
#Some time (aa couple of seconds) elapses
  - step_id : TD_COAP_CORE_09_v01_step_05
    type : check
    description:
      - 'Server sends response containing:'
      - - Type=2 (ACK)
        - Code=0
        - Message ID = SMID
        - Empty Payload

  - step_id : TD_COAP_CORE_09_v01_step_06
    type : verify
    node : coap_client
    description:
      - 'Client displays the response'

--- !testcase

testcase_id : TD_COAP_CORE_10_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_09_v01
objective: Perform GET transaction containing non-empty Token (CON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 2.2, 5.8.1, 5.10.1"
pre_conditions: Server offers a /test resource with content is not empty that handles GET
sequence:

  - step_id : TD_COAP_CORE_10_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - "Client is requested to send a GET request to server's resource with non-empty Token option"

  - step_id : TD_COAP_CORE_10_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=0 (CON)
        - Code=1 (GET)
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)
        - Length of the token should be between 1 to 8 Bytes

  - step_id : TD_COAP_CORE_10_v01_step_03
    type : check
    description:
      - 'Server sends response containing:'
      - - Code=2.05 (Content)
        - Message ID = CMID
        - Token = CTOK
        - Content-format option
        - Non-empty Payload

  - step_id : TD_COAP_CORE_10_v01_step_04
    type : verify
    node : coap_client
    description:
      - 'Client displays the response'

--- !testcase

testcase_id : TD_COAP_CORE_11_v01
uri : http://doc.f-interop.eu/tests/TD_COAP_CORE_09_v01
objective: Perform GET transaction containing non-empty Token with a separate response (CON mode)
configuration: COAP_CFG_01_v01
references: "[COAP] 2.2, 5.2.2, 5.8.1"
pre_conditions: Server offers a resource /separate which is not served immediately and which therefore is not acknowledged in a piggybacked way
sequence:

  - step_id : TD_COAP_CORE_11_v01_step_01
    type : stimuli
    node : coap_client
    description:
      - "Client is requested to send a GET request to server's resource including Token option"

  - step_id : TD_COAP_CORE_11_v01_step_02
    type : check
    description:
      - 'The request sent by the client contains:'
      - - Type=0 (CON)
        - Code=1 (GET)
        - Client-generated Message ID (➔ CMID)
        - Client-generated Token (➔ CTOK)
        - Length of the token should be between 1 to 8 Bytes

  - step_id : TD_COAP_CORE_11_v01_step_03
    type : check
    description:
      - 'Server sends response containing:'
      - - Type=2 (ACK)
        - Code=0
        - Message ID = CMID
        - Empty Payload

  - step_id : TD_COAP_CORE_11_v01_step_04
    type : check
    description:
      - 'Server sends response containing:'
      - - Code=0 (ACK)
        - Server-generated Message ID (➔ SMID)
        - Token = CTOK
        - Content-format option
        - Non-empty Payload

  - step_id : TD_COAP_CORE_11_v01_step_05
    type : check
    description:
      - 'Server sends response containing:'
      - - Code=2.05 (Content)
        - Message ID = CMID
        - Token = CTOK
        - Content-format option
        - Non-empty Payload

  - step_id : TD_COAP_CORE_11_v01_step_06
    type : verify
    node : coap_client
    description:
      - 'Client displays the response'